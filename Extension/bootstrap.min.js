!function(e){function t(a){if(n[a])return n[a].exports;var d=n[a]={exports:{},id:a,loaded:!1};return e[a].call(d.exports,d,d.exports,t),d.loaded=!0,d.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a;!function(e){var t=function(){function e(){}return e.prototype.addScriptTag=function(e,t,n){if(void 0===n&&(n=!1),null!=document.getElementById("VisualSPOnlineHelpAppScript_"+t)){if(!n)return;document.getElementById("VisualSPOnlineHelpAppScript_"+t).remove?document.getElementById("VisualSPOnlineHelpAppScript_"+t).remove():document.getElementById("VisualSPOnlineHelpAppScript_"+t).removeNode&&document.getElementById("VisualSPOnlineHelpAppScript_"+t).removeNode()}var a=document.createElement("SCRIPT");a.id="VisualSPOnlineHelpAppScript_"+t,a.src=e,a.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(a)},e.prototype.addCssLink=function(e,t,n){if(void 0===n&&(n=!1),null!=document.getElementById("VisualSPOnlineHelpAppCSS_"+t)){if(!n)return;document.getElementById("VisualSPOnlineHelpAppCSS_"+t).remove?document.getElementById("VisualSPOnlineHelpAppCSS_"+t).remove():document.getElementById("VisualSPOnlineHelpAppCSS_"+t).removeNode&&document.getElementById("VisualSPOnlineHelpAppCSS_"+t).removeNode()}var a=document.createElement("link");a.id="VisualSPOnlineHelpAppCSS_"+t,a.href=e,a.rel="stylesheet",a.type="text/css",document.getElementsByTagName("head")[0].appendChild(a)},e.prototype.handleMessage=function(e){if("GetVisualSPUserId"==e.name){for(var t=[],n=document.getElementsByTagName("iframe"),a=e.message.data,d=0;d<n.length;d++)t.push(n[d].contentWindow);for(var d=0;d<t.length;d++)t[d].postMessage({owner:"VisualSP",command:"GetUserIdResponse",data:a.VisualSPUserId,source:window.location.href},"*")}},e.prototype.sendMessage=function(e,t){void 0!=e&&(void 0==t?safari.extension.dispatchMessage(e):safari.extension.dispatchMessage(e,t))},e.prototype.initialize=function(){var e=this;safari.self.addEventListener("message",e.handleMessage),e.addScriptTag("https://visualsponline.azurewebsites.net/app/js/VisualSPHost.min.js?Extension=Safari&Version=1.0.1."+(new Date).valueOf(),"Main",!1),window.addEventListener("message",function(t){for(var n=[],a=document.getElementsByTagName("iframe"),d=0;d<a.length;d++)n.push(a[d].contentWindow);"VisualSP"===t.data.owner&&("GetUserId"===t.data.command?e.sendMessage("GetVisualSPUserId"):"SetUserId"===t.data.command?e.sendMessage("SetVisualSPUserId",{data:t.data.data}):"AddScriptTag"===t.data.command?e.addScriptTag(t.data.data.url,t.data.data.id,!0):"AddCssLink"===t.data.command&&e.addCssLink(t.data.data.url,t.data.data.id,!0))})},e}();e.InlineHelpBootstrap=t}(a||(a={})),document.addEventListener("DOMContentLoaded",function(e){(new a.InlineHelpBootstrap).initialize()})}]);